---
layout: post
title: IE7 z-index issue
date: '2012-03-25T15:23:00.000-04:00'
author: Bill Schneider
tags:
- ie7 css z-index
modified_time: '2012-04-20T09:54:33.656-04:00'
blogger_id: tag:blogger.com,1999:blog-9159309.post-1018977198357875953
blogger_orig_url: http://wrschneider.blogspot.com/2012/03/ie7-z-index-issue.html
---

The IE z-index bug is old news by now, but since I struggled so much to understand it as a relative newbie to CSS, I wanted to preserve an explanation for posterity.<br /><br />This is an illustration of the issue - also available via jsfiddle at <a href="http://jsfiddle.net/fhJxd/5/">http://jsfiddle.net/fhJxd/5/</a><br /><pre class="brush: xhtml"> &lt;div id="parent1" style="position: relative; width: 400px; height: 100px; background: #fcc"&gt;<br />   &lt;span&gt;red header&lt;/span&gt;<br />   &lt;div id="absoluteChild" style="position: absolute; top: 0px; left: 0px; width: 200px; height: 200px; z-index: 100; background: #cfc"&gt;<br />     &lt;span&gt;On all browsers except IE7, the green box will be on top of the blue box on bottom and cover some of the text&lt;/span&gt;<br />   &lt;/div&gt;<br /> &lt;/div&gt;<br /> &lt;div id="parent2" style="position: relative; width: 400px; height: 200px; background: #ccf"&gt;          <br />    &lt;span&gt;The text in this box is fully visible only on IE7.  Even though the green box has a high z-index, IE7 still paints the blue box on top &lt;/span&gt;<br /> &lt;/div&gt;<br /></pre><br /><div id="parent1" style="background: #fcc; height: 100px; position: relative; width: 400px;">red header               <br /><div id="absoluteChild" style="background: #cfc; height: 200px; left: 0px; position: absolute; top: 0px; width: 200px; z-index: 100;">On all browsers except IE7, the green box will be on top of the blue box on bottom and cover some of the text               </div></div><div id="parent2" style="background: #ccf; height: 200px; position: relative; width: 400px;">The text in this box is fully visible only on IE7.  Even though the green box has a high z-index, IE7 still paints the blue box on top         </div><br />This will look different in IE7 and everything else.  (The IE8/IE9 developer toolbar correctly replicate the IE7 behavior.)<br /><br />What's going on here?<br /><br />The first step is to understand that CSS z-index is not absolute - it's only relative within a "stacking context".  Every positioned element with an explicit z-index value (i.e., not 'auto') creates a new stacking context.  The z-index values are used to compare elements within the same stacking context; and stacking contexts are hierarchical, so the z-index of the positioned element that created the stacking context in the first place is compared against other elements in the same parent stacking context, and rendered accordingly with its descendants.  So it's actually possible for an element with a z-index of 100 to be behind an element with z-index 1, if both are descendants of different positioned elements.<br /><br />Once you understand that, it's much easier to understand the IE7 problem.  IE7's bug is that it treats the unspecified z-index on parent1 and parent2 the same as z-index:0, so parent1 and parent2 each define a new stacking context inadvertently.  The z-index of 100 on absoluteChild doesn't matter - the 100 is only used in comparison relative to other descendants of parent1.   Since both parent1 and parent2 have the same z-index value, the DOM order breaks the tie. &nbsp;Then parent2 plus its descendants will paint on top of parent1 and its descendants.<br /><br />More recent browsers (IE8+, Chrome, Firefox, etc.) will not create a new stacking context for parent1 and parent2. &nbsp; In that case, the z-index of 100 on absoluteChild causes it to render on top.<br /><br />There is another good example here:&nbsp;<a href="http://therealcrisp.xs4all.nl/ie7beta/css_zindex.html">http://therealcrisp.xs4all.nl/ie7beta/css_zindex.html</a><br /><br />